(this.webpackJsonpcyclog=this.webpackJsonpcyclog||[]).push([[0],{100:function(e,t,a){e.exports=a.p+"static/media/nathan.ee2493ef.png"},101:function(e,t,a){e.exports=a.p+"static/media/sarah.24ca4f60.jpeg"},102:function(e,t,a){e.exports=a.p+"static/media/jesse.a82637d5.jpeg"},214:function(e,t){},218:function(e,t){},269:function(e,t,a){e.exports=a.p+"static/media/directions_bike_24px.64beea8c.svg"},329:function(e,t,a){e.exports=a(738)},334:function(e,t,a){},732:function(e,t){},738:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(35),c=a.n(i),o=(a(334),a(103)),l=a(47),s=a(28),d=a(86),u=a(265),m=a(266),p=a(283),g=a(280),f=a(267),h=a.n(f),v=(a(337),a(196)),b="pk.eyJ1IjoibmF0aGFua2lwcCIsImEiOiJjazNid2k3enIwN2QzM2Nucmp5b3NmaXY0In0.cMIErB8-bLVio-MGSeXlfg",E={latitude:39,longitude:-97,zoom:3.25,transitionDuration:"auto",transitionInterpolator:new v.a},w={black:[0,0,0],red:[150,50,50],green:[50,150,50],blue:[50,50,150]},O=a(158),j=a.n(O);j.a.config.region="us-east-2",j.a.config.credentials=new j.a.CognitoIdentityCredentials({IdentityPoolId:"us-east-2:1056edee-e9e2-4c61-8f7e-45d31a5ab8a4"});var y=new j.a.DynamoDB.DocumentClient;function D(){return new Promise((function(e,t){y.scan({TableName:"cyclog"},(function(a,n){a?t("ride list cannot be retrieved"):e(n.Items.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{color:w.black})})))}))}))}function C(e){return new Promise((function(t,a){y.put({Item:e,TableName:"cyclog"},(function(e,n){e?a("ride was not saved"):t()}))}))}function S(e){return new Promise((function(t,a){y.delete({TableName:"cyclog",Key:{id:e.id}},(function(e,n){e?a(e):t()}))}))}var N=a(813),x=a(814),R=a(269),k=a.n(R);function I(e){return new N.a({id:e.name,data:[{coordinates:e.path}],iconAtlas:k.a,iconMapping:{rider:{x:0,y:0,width:24,height:24,mask:!0}},getIcon:function(){return"rider"},getColor:function(){return e.color},getPosition:function(e){return e.coordinates},sizeMinPixels:28})}function P(e){var t,a=[(t=e,new x.a({id:t.id,data:[{path:t.path}],getColor:function(){return t.color},rounded:!0,widthMinPixels:2}))];if(e.isSelected){var n=Object(s.a)(Object(s.a)({},e),{},{name:"".concat(e.name,"-start"),color:w.green,path:e.path[0]});if(a.push(I(n)),e.path.length>1){var r=Object(s.a)(Object(s.a)({},e),{},{name:"".concat(e.name,"-end"),color:w.red,path:e.path[e.path.length-1]});a.push(I(r))}}return a}var F=a(30),z=a(281),B=function(e){return"NEW_ID"!==e.id};function L(e){if(!e)return[];var t=[];return t.push(Object(s.a)(Object(s.a)({},e),{},{name:"".concat(e.name,"-start"),color:w.green,path:e.path[0]})),e.path.length>1&&t.push(Object(s.a)(Object(s.a)({},e),{},{name:"".concat(e.name,"-end"),color:w.red,path:e.path[e.path.length-1]})),t}var W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map((function(e){var a=e.id===t.id;return Object(s.a)(Object(s.a)({},e),{},{isSelected:a,riders:e.riders||"",icons:a?L(e):[],color:a?w.blue:w.black,milage:e.path.length>1?Object(z.a)(Object(F.e)(e.path),{units:"miles"}):0})}))},T=function(e,t){var a=[];return e.length&&(a=[{id:"NEW_ID",name:"\u2022 New ride \u2022",color:w.blue,path:e,viewport:t}]),a},G=function(e){var t=e.longitude,a=e.latitude,n=e.zoom;return Object(s.a)(Object(s.a)({},E),{},{longitude:t,latitude:a,zoom:n})},M=function(e){var t=e.params.riders;return t&&t.split(",")},_=a(810),V=a(124),A=a(12),H=a(787),J=Object(H.a)((function(e){return{drawerHeader:Object(s.a)(Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"space-between"}),content:{position:"relative",flexGrow:1,height:"100vh",padding:e.spacing(0),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-300},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},mainContent:{position:"absolute",top:0,right:0,bottom:0,left:0}}}));var X=function(e){var t=e.isDrawerOpen,a=e.children,n=J();return r.a.createElement("main",{className:Object(A.a)(n.content,Object(V.a)({},n.contentShift,t))},r.a.createElement("div",{className:n.drawerHeader}),r.a.createElement("div",{className:n.mainContent},a))},$=a(790),K=a(792),U=a(793),Y=a(747),Q=a(140),q=a(274),Z=a.n(q),ee=a(100),te=a.n(ee),ae=a(101),ne=a.n(ae),re=a(102),ie=a.n(re),ce=Object(H.a)((function(e){return{appBar:{backgroundColor:"#323296",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(300,"px)"),marginLeft:300,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},hide:{display:"none"},hideForSmall:{"@media only screen and (max-width: 620px)":{display:"none"}},avatars:{display:"flex",alignItems:"flex-end",position:"absolute",right:e.spacing(2),"@media only screen and (max-width: 420px)":{right:e.spacing(1)}},avatar:{marginRight:e.spacing(2),"@media only screen and (max-width: 420px)":{height:e.spacing(4),width:e.spacing(4),marginRight:e.spacing(1)}},inactive:{opacity:.25},menuButton:{marginRight:e.spacing(2)}}}));var oe=Object(l.h)(r.a.memo((function(e){var t=e.match,a=e.isDrawerOpen,n=e.toggleDrawer,i=(e.addRider,e.removeRider,ce()),c=t.params,l=c.riders,s=c.rideId;return r.a.createElement($.a,{position:"fixed",className:Object(A.a)(i.appBar,Object(V.a)({},i.appBarShift,a))},r.a.createElement(K.a,null,r.a.createElement(U.a,{color:"inherit","aria-label":"open drawer",onClick:function(){return n(!0)},edge:"start",className:Object(A.a)(i.menuButton,a&&i.hide)},r.a.createElement(Z.a,null)),r.a.createElement(Q.a,{variant:"h6",noWrap:!0},"Sibling Cyclog"),r.a.createElement("div",{className:Object(A.a)(i.avatars,a&&i.hide)},[te.a,ne.a,ie.a].map((function(e){var t=e.replace(/^.*\/(\w+)..*$/,"$1"),n=function(e){return!l.includes(e)}(t),c=function(){return r.a.createElement(Y.a,{className:Object(A.a)(i.avatar,n&&i.inactive,a&&i.hideForSmall),src:e})};if(n){var d="".concat(l.concat(",".concat(t)));return r.a.createElement(o.b,{key:t,to:"/".concat(d).concat(s?"/".concat(s):"")},r.a.createElement(c,null))}if(l.includes(",")){var u=l.split(",").filter((function(e){return e!==t})).join(",");return r.a.createElement(o.b,{key:t,to:"/".concat(u).concat(s?"/".concat(s):"")},r.a.createElement(c,null))}return r.a.createElement(c,{key:t})})))))}))),le=a(815),se=a(794),de=a(275),ue=a.n(de),me=Object(H.a)((function(e){return{drawer:{width:300,flexShrink:0},drawerPaper:{width:300},drawerHeader:Object(s.a)(Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"space-between"})}}));var pe=r.a.memo((function(e){var t=e.isDrawerOpen,a=e.toggleDrawer,n=e.children,i=me();return r.a.createElement(le.a,{className:i.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:i.drawerPaper}},r.a.createElement("div",{className:i.drawerHeader},r.a.createElement(Q.a,{variant:"h6",noWrap:!0},"Rides"),r.a.createElement(U.a,{onClick:function(){return a(!1)}},r.a.createElement(ue.a,null))),r.a.createElement(se.a,null),n)})),ge=a(795),fe=a(796),he=a(797),ve=Object(H.a)((function(e){return{card:{paddingLeft:e.spacing(5),position:"absolute",top:e.spacing(10),right:"50%",transform:"translateX(50%)"},cardContent:{"&:last-child":{paddingBottom:e.spacing(1)},display:"flex",justifyContent:"space-around"},avatarGroup:{position:"absolute",left:e.spacing(1),top:"50%",transform:"translateY(-50%)",flexDirection:"column",marginTop:4,marginLeft:8},avatar:{borderWidth:1,margin:"-6px 0 0 0",height:e.spacing(3),width:e.spacing(3)}}})),be=function(e){switch(e){case"sarah":return ne.a;case"jesse":return ie.a;case"nathan":return te.a;default:return}};var Ee=function(e){var t=e.ride,a=ve(),n=t.date,i=t.milage,c=void 0===i?0:i,o=t.name,l=t.riders,s=void 0===l?"":l,d=n?[n]:[];return void 0!==c&&d.push("".concat(c.toFixed(1),"mi")),d=d.join(" \u2022 "),r.a.createElement(ge.a,{className:a.card},r.a.createElement(fe.a,{className:a.cardContent},r.a.createElement(he.a,{className:a.avatarGroup},s.split(",").map((function(e){return r.a.createElement(Y.a,{key:e,className:a.avatar,src:be(e)})}))),r.a.createElement("div",null,r.a.createElement(Q.a,{variant:"h6"},o),r.a.createElement(Q.a,{variant:"subtitle1"},d))))},we=a(798),Oe=a(799),je=a(800),ye=a(277),De=a.n(ye),Ce=a(193),Se=a.n(Ce),Ne=a(276),xe=a.n(Ne),Re=a(801),ke=Object(H.a)((function(e){return{root:{"& a":{color:"black",textDecoration:"none"}},loadingRides:{padding:e.spacing(0,2)},bikeIcon:{minWidth:40},avatarGroup:{flexDirection:"column",marginTop:8,marginRight:8},avatar:{borderWidth:1,margin:"-6px 0 0 0",height:e.spacing(3),width:e.spacing(3)},rideName:{"& span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},paddingRight:"0 10px 0 0"},selected:{paddingRight:75},actionIcons:{position:"absolute",right:8,zIndex:10},actionIconButton:{marginLeft:8,padding:8}}})),Ie=function(e){switch(e){case"sarah":return ne.a;case"jesse":return ie.a;case"nathan":return te.a;default:return}},Pe=function(e){return function(e){return new URLSearchParams(e)}(e).has("admin")};var Fe=Object(l.h)(r.a.memo((function(e){var t=e.match,a=e.rides,n=e.selectRide,i=e.toggleSaveDialog,c=e.toggleDeleteConfirm,s=(e.children,ke()),d=t.params.riders,u=Pe(Object(l.g)().search);return r.a.createElement(we.a,{className:s.root},!a.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,null,r.a.createElement(je.a,{primary:"Loading..."})),r.a.createElement("div",{className:s.loadingRides},r.a.createElement(Re.a,null))),a.sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){var t=e.id,a=e.name,l=e.isSelected,m=e.milage,p=e.date,g="NEW_ID"===t,f=u&&l&&!g,h=p?[p]:[];return h.push("".concat(m.toFixed(1),"mi")),h=h.join(" \u2022 "),r.a.createElement(o.b,{to:"/".concat(d,"/").concat(t),key:a.concat(t)},r.a.createElement(Oe.a,{button:!0,onClick:function(){return function(e){return n(e)}(e)},selected:l,disableTouchRipple:l},r.a.createElement(he.a,{className:s.avatarGroup},e.riders.split(",").map((function(e){return r.a.createElement(Y.a,{key:e,className:s.avatar,src:Ie(e)})}))),r.a.createElement(je.a,{className:Object(A.a)(s.rideName,f&&s.selected),primary:e.name,secondary:h}),g&&r.a.createElement(U.a,{size:"small",className:s.actionIcons,disabled:!0},r.a.createElement(xe.a,{fontSize:"small"})),f&&r.a.createElement("div",{className:s.actionIcons},r.a.createElement(U.a,{className:s.actionIconButton,size:"small",color:"primary",onClick:function(e){e.preventDefault(),e.stopPropagation(),i(!0)}},r.a.createElement(De.a,{fontSize:"small"})),r.a.createElement(U.a,{className:s.actionIconButton,color:"secondary",size:"small",onClick:function(e){e.preventDefault(),e.stopPropagation(),c(!0)}},r.a.createElement(Se.a,{fontSize:"small"})))))})))}))),ze=a(812),Be=function(e){var t=e.viewport,a=e.setViewport,n=e.path,i=e.setPath,c=e.layers;return r.a.createElement(v.b,Object.assign({},t,{onClick:function(e){i([].concat(Object(d.a)(n),[e.lngLat])),a(Object(s.a)(Object(s.a)({},t),{},{longitude:e.lngLat[0],latitude:e.lngLat[1]}))},onViewportChange:a,mapboxApiAccessToken:b,mapStyle:"mapbox://styles/mapbox/outdoors-v11",height:"100%",width:"100%"}),r.a.createElement(ze.a,{viewState:t,layers:c}))},Le=a(278),We=a.n(Le),Te=a(279),Ge=a.n(Te),Me=Object(H.a)((function(e){return{card:{position:"absolute",bottom:e.spacing(3),right:"50%",transform:"translateX(50%)",width:200},cardContent:{display:"flex",justifyContent:"space-around",padding:e.spacing(1),"&:last-child":{paddingBottom:e.spacing(1)}},undo:{color:"#323296"},save:{color:"#329632"},delete:{color:"#963232"}}}));var _e=r.a.memo((function(e){var t=e.undoPath,a=e.toggleSaveDialog,n=e.toggleDeleteConfirm,i=Me();return r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.a,{className:i.card},r.a.createElement(fe.a,{className:i.cardContent},r.a.createElement(U.a,{"aria-label":"undo",className:i.undo,onClick:function(){return t()}},r.a.createElement(We.a,null)),r.a.createElement(U.a,{"aria-label":"save",className:i.save,onClick:function(){return a(!0)}},r.a.createElement(Ge.a,null)),r.a.createElement(U.a,{"aria-label":"trash",className:i.delete,onClick:function(){return n(!0)}},r.a.createElement(Se.a,null)))))})),Ve=a(161),Ae=a(808),He=a(811),Je=a(803),Xe=a(807),$e=a(805),Ke=a(806),Ue=a(804),Ye=a(809),Qe=Object(H.a)((function(e){return{wrapper:{margin:e.spacing(1),position:"relative"},avatars:{display:"flex",justifyContent:"space-evenly"},avatar:{cursor:"pointer",margin:e.spacing(2)},inactive:{opacity:.25},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),qe=function(e){return e&&e.split(",")||[]};var Ze=r.a.memo((function(e){var t=e.open,a=e.toggle,i=e.ride,c=e.saveRide,o=Object(n.useState)(i.name||""),l=Object(Ve.a)(o,2),u=l[0],m=l[1],p=Object(n.useState)(qe(i.riders)),g=Object(Ve.a)(p,2),f=g[0],h=g[1],v=Object(n.useState)(i.date||""),b=Object(Ve.a)(v,2),E=b[0],w=b[1],O=Object(n.useState)(!1),j=Object(Ve.a)(O,2),y=j[0],D=j[1],C=Qe();Object(n.useEffect)((function(){h(qe(i.riders)),m(i.name),w(i.date)}),[i]);var S=function(){return a(!1)},N={name:i.id?"Update this ride":"Save your ride"};return r.a.createElement(Je.a,{open:t,onClose:S,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ue.a,{id:"form-dialog-title",style:{minWidth:300}},"Ride Details"),r.a.createElement($e.a,null,r.a.createElement(Ke.a,null,N.name),r.a.createElement("div",{className:C.avatars},[te.a,ne.a,ie.a].map((function(e){var t=e.replace(/^.*\/(\w+)..*$/,"$1"),a=!f.includes(t);return r.a.createElement(Y.a,{key:t,className:Object(A.a)(C.avatar,a&&C.inactive),src:e,onClick:function(){a?function(e){h([].concat(Object(d.a)(f),[e]))}(t):function(e){h(f.filter((function(t){return t!==e})))}(t)}})}))),r.a.createElement(He.a,{autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,onChange:function(e){var t=e.target.value;return m(t)},value:u}),r.a.createElement(He.a,{margin:"dense",id:"date",label:"Date",type:"text",fullWidth:!0,onChange:function(e){var t=e.target.value;return w(t)},value:E})),r.a.createElement(Xe.a,null,r.a.createElement(Ae.a,{variant:"contained",color:"primary",onClick:S,disabled:y},"Cancel"),r.a.createElement("div",{className:C.wrapper},r.a.createElement(Ae.a,{variant:"contained",color:"primary",onClick:function(){D(!0);var e=f.sort((function(e,t){return e[1].localeCompare(t[1])})).join(",")||void 0;c(Object(s.a)(Object(s.a)({},i),{},{riders:e,name:u,date:E})).finally((function(){D(!1)}))},disabled:y},"Save"),y&&r.a.createElement(Ye.a,{className:C.buttonProgress,size:24}))))}));var et=r.a.memo((function(e){var t=e.open,a=e.toggle,n=e.deleteFn,i=function(){a(!1)};return r.a.createElement(Je.a,{open:t,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Ue.a,{id:"alert-dialog-title"},"Are you sure?"),r.a.createElement($e.a,null,r.a.createElement(Ke.a,{id:"alert-dialog-description"},"Deleting a ride is permanent and irreversible.")),r.a.createElement(Xe.a,null,r.a.createElement(Ae.a,{onClick:i,variant:"contained",color:"primary"},"Keep my Ride"),r.a.createElement(Ae.a,{onClick:function(){n().then(i)},variant:"contained",color:"secondary"},"Delete Forever")))})),tt=function(e){Object(p.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={rides:[],riders:M(e.props.match),selectedRide:{},path:[],viewport:E,isDrawerOpen:!0,isSaveDialogOpen:!1,isDeleteConfirmOpen:!1,deleteFn:null},e.componentDidMount=function(){var t=e.props.match.params.rideId;D().then(W).then((function(a){return e.setState({rides:a},(function(){var n=a.find((function(e){return e.id===t}));n&&e.selectRide(n)}))}))},e.deleteRideFn=function(t){return function(){var a=e.state.rides;return S(t).then((function(){return new Promise((function(n){return e.setState({rides:a.filter((function(e){return e.id!==t.id})),selectedRide:{}},n)}))}))}},e.selectRide=function(t){var a=e.state.rides,n=W(a,t),r=G(t.viewport),i=e.deleteRideFn(t);e.setState({selectedRide:t,rides:n,deleteFn:i,viewport:r})},e.setPath=function(t){var a={path:t,deleteFn:function(){return e.setPath([])}},n=e.state,r=n.rides,i=n.viewport;if(t.length){var c=T(t,i),o=[].concat(Object(d.a)(r.filter(B)),Object(d.a)(c));a.rides=W(o,c[0]),a.selectedRide=a.rides.find((function(e){return e.isSelected}))}else a.rides=r.filter(B),a.selectedRide={};return new Promise((function(t){return e.setState(a,t)}))},e.undoPath=function(){var t=e.state.path;e.setPath(t.slice(0,-1))},e.saveRide=function(t){var a=e.state,n=a.path,r=a.viewport,i="NEW_ID"===t.id,c=i?h()():t.id,o=Object(s.a)(Object(s.a)({},t),{},{id:c,viewport:r});return C(o).then(D).then((function(e){var t=Object(d.a)(e.filter(B));return!i&&n.length&&t.push(T(n,r)[0]),W(t,o)})).then((function(t){e.setState({rides:t,selectedRide:o,deleteFn:e.deleteRideFn(o),path:i?[]:n,isSaveDialogOpen:!1})}))},e.toggleDrawer=function(t){return e.setState({isDrawerOpen:t})},e.toggleSaveDialog=function(t){return e.setState({isSaveDialogOpen:t})},e.toggleDeleteConfirm=function(t){return e.setState({isDeleteConfirmOpen:t})},e.setViewport=function(t){return e.setState({viewport:t})},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state,t=e.rides,a=e.selectedRide,n=e.path,i=e.viewport,c=e.isDrawerOpen,o=e.isSaveDialogOpen,l=e.isDeleteConfirmOpen,s=e.deleteFn,u=this.props.match.params.riders,m=t.filter((function(e){return u.split(",").map((function(t){return e.riders.includes(t)||!e.riders})).every((function(e){return e}))})),p=Object(d.a)(m.map(P)),g=!!n.length&&a&&"NEW_ID"===a.id;return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(_.a,null),r.a.createElement(oe,{isDrawerOpen:c,toggleDrawer:this.toggleDrawer,riders:u,addRider:this.addRider,removeRider:this.removeRider}),r.a.createElement(pe,{isDrawerOpen:c,toggleDrawer:this.toggleDrawer},r.a.createElement(Fe,{rides:m,selectRide:this.selectRide,toggleSaveDialog:this.toggleSaveDialog,toggleDeleteConfirm:this.toggleDeleteConfirm})),r.a.createElement(X,{isDrawerOpen:c},r.a.createElement(Be,{viewport:i,setViewport:this.setViewport,path:n,setPath:this.setPath,layers:p}),a.id&&r.a.createElement(Ee,{ride:a}),g&&r.a.createElement(_e,{undoPath:this.undoPath,toggleSaveDialog:this.toggleSaveDialog,toggleDeleteConfirm:this.toggleDeleteConfirm})),r.a.createElement(Ze,{open:o,toggle:this.toggleSaveDialog,ride:a,saveRide:this.saveRide}),r.a.createElement(et,{open:l,toggle:this.toggleDeleteConfirm,deleteFn:s}))}}]),a}(r.a.Component),at=Object(l.h)(tt);c.a.render(r.a.createElement(o.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/:riders([nathan|sarah|jesse|,]+)/:rideId?",component:at}),r.a.createElement(l.b,{render:function(){return r.a.createElement(l.a,{to:"/nathan,sarah,jesse"})}}))),document.getElementById("root"))}},[[329,1,2]]]);
//# sourceMappingURL=main.605e0ba7.chunk.js.map