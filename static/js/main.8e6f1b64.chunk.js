(this.webpackJsonpcyclog=this.webpackJsonpcyclog||[]).push([[0],{100:function(e,t,a){e.exports=a.p+"static/media/jesse.a82637d5.jpeg"},210:function(e,t){},214:function(e,t){},266:function(e,t,a){e.exports=a.p+"static/media/directions_bike_24px.64beea8c.svg"},327:function(e,t,a){e.exports=a(738)},332:function(e,t,a){},730:function(e,t){},738:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(36),o=a.n(i),c=(a(332),a(101)),l=a(104),s=a(46),d=a(83),u=a(261),m=a(262),p=a(279),g=a(263),f=a(281),h=a(264),v=a.n(h),b=(a(335),a(192)),E="pk.eyJ1IjoibmF0aGFua2lwcCIsImEiOiJjazNid2k3enIwN2QzM2Nucmp5b3NmaXY0In0.cMIErB8-bLVio-MGSeXlfg",w={latitude:39,longitude:-97,zoom:3.25,transitionDuration:"auto",transitionInterpolator:new b.a},O={black:[0,0,0],red:[150,50,50],green:[50,150,50],blue:[50,50,150]},j=a(157),y=a.n(j);y.a.config.region="us-east-2",y.a.config.credentials=new y.a.CognitoIdentityCredentials({IdentityPoolId:"us-east-2:1056edee-e9e2-4c61-8f7e-45d31a5ab8a4"});var D=new y.a.DynamoDB.DocumentClient;function C(){return new Promise((function(e,t){D.scan({TableName:"cyclog"},(function(a,n){a?t("ride list cannot be retrieved"):e(n.Items.map((function(e){return Object(s.a)({},e,{color:O.black})})))}))}))}function S(e){return new Promise((function(t,a){D.put({Item:e,TableName:"cyclog"},(function(e,n){e?a("ride was not saved"):t()}))}))}function N(e){return new Promise((function(t,a){D.delete({TableName:"cyclog",Key:{id:e.id}},(function(e,n){e?a(e):t()}))}))}var x=a(814),R=a(815),k=a(266),I=a.n(k);function P(e){return new x.a({id:e.name,data:[{coordinates:e.path}],iconAtlas:I.a,iconMapping:{rider:{x:0,y:0,width:24,height:24,mask:!0}},getIcon:function(){return"rider"},getColor:function(){return e.color},getPosition:function(e){return e.coordinates},sizeMinPixels:28})}function F(e){var t,a=[(t=e,new R.a({id:t.id,data:[{path:t.path}],getColor:function(){return t.color},rounded:!0,widthMinPixels:2}))];if(e.isSelected){var n=Object(s.a)({},e,{name:"".concat(e.name,"-start"),color:O.green,path:e.path[0]});if(a.push(P(n)),e.path.length>1){var r=Object(s.a)({},e,{name:"".concat(e.name,"-end"),color:O.red,path:e.path[e.path.length-1]});a.push(P(r))}}return a}var z=a(29),B=a(278),L=function(e){return"NEW_ID"!==e.id};function W(e){if(!e)return[];var t=[];return t.push(Object(s.a)({},e,{name:"".concat(e.name,"-start"),color:O.green,path:e.path[0]})),e.path.length>1&&t.push(Object(s.a)({},e,{name:"".concat(e.name,"-end"),color:O.red,path:e.path[e.path.length-1]})),t}var T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map((function(e){var a=e.id===t.id;return Object(s.a)({},e,{isSelected:a,riders:e.riders||"",icons:a?W(e):[],color:a?O.blue:O.black,milage:e.path.length>1?Object(B.a)(Object(z.e)(e.path),{units:"miles"}):0})}))},G=function(e,t){var a=[];return e.length&&(a=[{id:"NEW_ID",name:"\u2022 New ride \u2022",color:O.blue,path:e,viewport:t}]),a},M=function(e){var t=e.longitude,a=e.latitude,n=e.zoom;return Object(s.a)({},w,{longitude:t,latitude:a,zoom:n})},_=function(e){var t=e.params.riders;return t&&t.split(",")},V=a(811),A=a(124),H=a(12),J=a(788),X=Object(J.a)((function(e){return{drawerHeader:Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"space-between"}),content:{position:"relative",flexGrow:1,height:"100vh",padding:e.spacing(0),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-300},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},mainContent:{position:"absolute",top:0,right:0,bottom:0,left:0}}}));var $=function(e){var t=e.isDrawerOpen,a=e.children,n=X();return r.a.createElement("main",{className:Object(H.a)(n.content,Object(A.a)({},n.contentShift,t))},r.a.createElement("div",{className:n.drawerHeader}),r.a.createElement("div",{className:n.mainContent},a))},K=a(791),U=a(793),Y=a(794),Q=a(747),q=a(139),Z=a(271),ee=a.n(Z),te=a(98),ae=a.n(te),ne=a(99),re=a.n(ne),ie=a(100),oe=a.n(ie),ce=Object(J.a)((function(e){return{appBar:{backgroundColor:"#323296",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(300,"px)"),marginLeft:300,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},hide:{display:"none"},hideForSmall:{"@media only screen and (max-width: 620px)":{display:"none"}},avatars:{display:"flex",alignItems:"flex-end",position:"absolute",right:e.spacing(2),"@media only screen and (max-width: 420px)":{right:e.spacing(1)}},avatar:{marginRight:e.spacing(2),"@media only screen and (max-width: 420px)":{height:e.spacing(4),width:e.spacing(4),marginRight:e.spacing(1)}},inactive:{opacity:.25},menuButton:{marginRight:e.spacing(2)}}}));var le=Object(l.h)(r.a.memo((function(e){var t=e.match,a=e.isDrawerOpen,n=e.toggleDrawer,i=(e.addRider,e.removeRider,ce()),o=t.params,l=o.riders,s=o.rideId;return r.a.createElement(K.a,{position:"fixed",className:Object(H.a)(i.appBar,Object(A.a)({},i.appBarShift,a))},r.a.createElement(U.a,null,r.a.createElement(Y.a,{color:"inherit","aria-label":"open drawer",onClick:function(){return n(!0)},edge:"start",className:Object(H.a)(i.menuButton,a&&i.hide)},r.a.createElement(ee.a,null)),r.a.createElement(q.a,{variant:"h6",noWrap:!0},"Sibling Cyclog"),r.a.createElement("div",{className:Object(H.a)(i.avatars,a&&i.hide)},[ae.a,re.a,oe.a].map((function(e){var t=e.replace(/^.*\/(\w+)..*$/,"$1"),n=function(e){return!l.includes(e)}(t),o=function(){return r.a.createElement(Q.a,{className:Object(H.a)(i.avatar,n&&i.inactive,a&&i.hideForSmall),src:e})};if(n){var d="".concat(l.concat(",".concat(t)));return r.a.createElement(c.b,{key:t,to:"/".concat(d).concat(s?"/".concat(s):"")},r.a.createElement(o,null))}if(l.includes(",")){var u=l.split(",").filter((function(e){return e!==t})).join(",");return r.a.createElement(c.b,{key:t,to:"/".concat(u).concat(s?"/".concat(s):"")},r.a.createElement(o,null))}return r.a.createElement(o,{key:t})})))))}))),se=a(816),de=a(795),ue=a(273),me=a.n(ue),pe=Object(J.a)((function(e){return{drawer:{width:300,flexShrink:0},drawerPaper:{width:300},drawerHeader:Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"space-between"})}}));var ge=r.a.memo((function(e){var t=e.isDrawerOpen,a=e.toggleDrawer,n=e.children,i=pe();return r.a.createElement(se.a,{className:i.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:i.drawerPaper}},r.a.createElement("div",{className:i.drawerHeader},r.a.createElement(q.a,{variant:"h6",noWrap:!0},"Rides"),r.a.createElement(Y.a,{onClick:function(){return a(!1)}},r.a.createElement(me.a,null))),r.a.createElement(de.a,null),n)})),fe=a(796),he=a(797),ve=a(798),be=Object(J.a)((function(e){return{card:{paddingLeft:e.spacing(5),position:"absolute",top:e.spacing(10),right:"50%",transform:"translateX(50%)"},cardContent:{"&:last-child":{paddingBottom:e.spacing(1)},display:"flex",justifyContent:"space-around"},avatarGroup:{position:"absolute",left:e.spacing(1),top:"50%",transform:"translateY(-50%)",flexDirection:"column",marginTop:4,marginLeft:8},avatar:{borderWidth:1,margin:"-6px 0 0 0",height:e.spacing(3),width:e.spacing(3)}}})),Ee=function(e){switch(e){case"sarah":return re.a;case"jesse":return oe.a;case"nathan":return ae.a;default:return}};var we=function(e){var t=e.ride,a=be(),n=t.date,i=t.milage,o=void 0===i?0:i,c=t.name,l=t.riders,s=void 0===l?"":l,d=n?[n]:[];return void 0!==o&&d.push("".concat(o.toFixed(1),"mi")),d=d.join(" \u2022 "),r.a.createElement(fe.a,{className:a.card},r.a.createElement(he.a,{className:a.cardContent},r.a.createElement(ve.a,{className:a.avatarGroup},s.split(",").map((function(e){return r.a.createElement(Q.a,{key:e,className:a.avatar,src:Ee(e)})}))),r.a.createElement("div",null,r.a.createElement(q.a,{variant:"h6"},c),r.a.createElement(q.a,{variant:"subtitle1"},d))))},Oe=a(799),je=a(800),ye=a(801),De=a(275),Ce=a.n(De),Se=a(189),Ne=a.n(Se),xe=a(274),Re=a.n(xe),ke=a(802),Ie=Object(J.a)((function(e){return{root:{"& a":{color:"black",textDecoration:"none"}},loadingRides:{padding:e.spacing(0,2)},bikeIcon:{minWidth:40},avatarGroup:{flexDirection:"column",marginTop:8,marginRight:8},avatar:{borderWidth:1,margin:"-6px 0 0 0",height:e.spacing(3),width:e.spacing(3)},rideName:{"& span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},paddingRight:"0 10px 0 0"},selected:{paddingRight:75},actionIcons:{position:"absolute",right:8,zIndex:10},actionIconButton:{marginLeft:8,padding:8}}})),Pe=function(e){switch(e){case"sarah":return re.a;case"jesse":return oe.a;case"nathan":return ae.a;default:return}},Fe=function(e){return function(e){return new URLSearchParams(e)}(e).has("admin")};var ze=Object(l.h)(r.a.memo((function(e){var t=e.match,a=e.rides,n=e.selectRide,i=e.toggleSaveDialog,o=e.toggleDeleteConfirm,s=(e.children,Ie()),d=t.params.riders,u=Fe(Object(l.g)().search);return r.a.createElement(Oe.a,{className:s.root},!a.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement(je.a,null,r.a.createElement(ye.a,{primary:"Loading..."})),r.a.createElement("div",{className:s.loadingRides},r.a.createElement(ke.a,null))),a.sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){var t=e.id,a=e.name,l=e.isSelected,m=e.milage,p=e.date,g="NEW_ID"===t,f=u&&l&&!g,h=p?[p]:[];return h.push("".concat(m.toFixed(1),"mi")),h=h.join(" \u2022 "),r.a.createElement(c.b,{to:"/".concat(d,"/").concat(t),key:a.concat(t)},r.a.createElement(je.a,{button:!0,onClick:function(){return function(e){return n(e)}(e)},selected:l,disableTouchRipple:l},r.a.createElement(ve.a,{className:s.avatarGroup},e.riders.split(",").map((function(e){return r.a.createElement(Q.a,{key:e,className:s.avatar,src:Pe(e)})}))),r.a.createElement(ye.a,{className:Object(H.a)(s.rideName,f&&s.selected),primary:e.name,secondary:h}),g&&r.a.createElement(Y.a,{size:"small",className:s.actionIcons,disabled:!0},r.a.createElement(Re.a,{fontSize:"small"})),f&&r.a.createElement("div",{className:s.actionIcons},r.a.createElement(Y.a,{className:s.actionIconButton,size:"small",color:"primary",onClick:function(e){e.preventDefault(),e.stopPropagation(),i(!0)}},r.a.createElement(Ce.a,{fontSize:"small"})),r.a.createElement(Y.a,{className:s.actionIconButton,color:"secondary",size:"small",onClick:function(e){e.preventDefault(),e.stopPropagation(),o(!0)}},r.a.createElement(Ne.a,{fontSize:"small"})))))})))}))),Be=a(813),Le=function(e){var t=e.viewport,a=e.setViewport,n=e.path,i=e.setPath,o=e.layers;return r.a.createElement(b.b,Object.assign({},t,{onClick:function(e){i([].concat(Object(d.a)(n),[e.lngLat])),a(Object(s.a)({},t,{longitude:e.lngLat[0],latitude:e.lngLat[1]}))},onViewportChange:a,mapboxApiAccessToken:E,mapStyle:"mapbox://styles/mapbox/outdoors-v11",height:"100%",width:"100%"}),r.a.createElement(Be.a,{viewState:t,layers:o}))},We=a(276),Te=a.n(We),Ge=a(277),Me=a.n(Ge),_e=Object(J.a)((function(e){return{card:{position:"absolute",bottom:e.spacing(3),right:"50%",transform:"translateX(50%)",width:200},cardContent:{display:"flex",justifyContent:"space-around",padding:e.spacing(1),"&:last-child":{paddingBottom:e.spacing(1)}},undo:{color:"#323296"},save:{color:"#329632"},delete:{color:"#963232"}}}));var Ve=r.a.memo((function(e){var t=e.undoPath,a=e.toggleSaveDialog,n=e.toggleDeleteConfirm,i=_e();return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{className:i.card},r.a.createElement(he.a,{className:i.cardContent},r.a.createElement(Y.a,{"aria-label":"undo",className:i.undo,onClick:function(){return t()}},r.a.createElement(Te.a,null)),r.a.createElement(Y.a,{"aria-label":"save",className:i.save,onClick:function(){return a(!0)}},r.a.createElement(Me.a,null)),r.a.createElement(Y.a,{"aria-label":"trash",className:i.delete,onClick:function(){return n(!0)}},r.a.createElement(Ne.a,null)))))})),Ae=a(160),He=a(809),Je=a(812),Xe=a(804),$e=a(808),Ke=a(806),Ue=a(807),Ye=a(805),Qe=a(810),qe=Object(J.a)((function(e){return{wrapper:{margin:e.spacing(1),position:"relative"},avatars:{display:"flex",justifyContent:"space-evenly"},avatar:{cursor:"pointer",margin:e.spacing(2)},inactive:{opacity:.25},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),Ze=function(e){return e&&e.split(",")||[]};var et=r.a.memo((function(e){var t=e.open,a=e.toggle,i=e.ride,o=e.saveRide,c=Object(n.useState)(i.name||""),l=Object(Ae.a)(c,2),u=l[0],m=l[1],p=Object(n.useState)(Ze(i.riders)),g=Object(Ae.a)(p,2),f=g[0],h=g[1],v=Object(n.useState)(i.date||""),b=Object(Ae.a)(v,2),E=b[0],w=b[1],O=Object(n.useState)(!1),j=Object(Ae.a)(O,2),y=j[0],D=j[1],C=qe();Object(n.useEffect)((function(){h(Ze(i.riders)),m(i.name),w(i.date)}),[i]);var S=function(){return a(!1)},N={name:i.id?"Update this ride":"Save your ride"};return r.a.createElement(Xe.a,{open:t,onClose:S,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ye.a,{id:"form-dialog-title",style:{minWidth:300}},"Ride Details"),r.a.createElement(Ke.a,null,r.a.createElement(Ue.a,null,N.name),r.a.createElement("div",{className:C.avatars},[ae.a,re.a,oe.a].map((function(e){var t=e.replace(/^.*\/(\w+)..*$/,"$1"),a=!f.includes(t);return r.a.createElement(Q.a,{key:t,className:Object(H.a)(C.avatar,a&&C.inactive),src:e,onClick:function(){a?function(e){h([].concat(Object(d.a)(f),[e]))}(t):function(e){h(f.filter((function(t){return t!==e})))}(t)}})}))),r.a.createElement(Je.a,{autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,onChange:function(e){var t=e.target.value;return m(t)},value:u}),r.a.createElement(Je.a,{margin:"dense",id:"date",label:"Date",type:"text",fullWidth:!0,onChange:function(e){var t=e.target.value;return w(t)},value:E})),r.a.createElement($e.a,null,r.a.createElement(He.a,{variant:"contained",color:"primary",onClick:S,disabled:y},"Cancel"),r.a.createElement("div",{className:C.wrapper},r.a.createElement(He.a,{variant:"contained",color:"primary",onClick:function(){D(!0);var e=f.sort((function(e,t){return e[1].localeCompare(t[1])})).join(",")||void 0;o(Object(s.a)({},i,{riders:e,name:u,date:E})).finally((function(){D(!1)}))},disabled:y},"Save"),y&&r.a.createElement(Qe.a,{className:C.buttonProgress,size:24}))))}));var tt=r.a.memo((function(e){var t=e.open,a=e.toggle,n=e.deleteFn,i=function(){a(!1)};return r.a.createElement(Xe.a,{open:t,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Ye.a,{id:"alert-dialog-title"},"Are you sure?"),r.a.createElement(Ke.a,null,r.a.createElement(Ue.a,{id:"alert-dialog-description"},"Deleting a ride is permanent and irreversible.")),r.a.createElement($e.a,null,r.a.createElement(He.a,{onClick:i,variant:"contained",color:"primary"},"Keep my Ride"),r.a.createElement(He.a,{onClick:function(){n().then(i)},variant:"contained",color:"secondary"},"Delete Forever")))})),at=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={rides:[],riders:_(a.props.match),selectedRide:{},path:[],viewport:w,isDrawerOpen:!0,isSaveDialogOpen:!1,isDeleteConfirmOpen:!1,deleteFn:null},a.componentDidMount=function(){var e=a.props.match.params.rideId;C().then(T).then((function(t){return a.setState({rides:t},(function(){var n=t.find((function(t){return t.id===e}));n&&a.selectRide(n)}))}))},a.deleteRideFn=function(e){return function(){var t=a.state.rides;return N(e).then((function(){return new Promise((function(n){return a.setState({rides:t.filter((function(t){return t.id!==e.id})),selectedRide:{}},n)}))}))}},a.selectRide=function(e){var t=a.state.rides,n=T(t,e),r=M(e.viewport),i=a.deleteRideFn(e);a.setState({selectedRide:e,rides:n,deleteFn:i,viewport:r})},a.setPath=function(e){var t={path:e,deleteFn:function(){return a.setPath([])}},n=a.state,r=n.rides,i=n.viewport;if(e.length){var o=G(e,i),c=[].concat(Object(d.a)(r.filter(L)),Object(d.a)(o));t.rides=T(c,o[0]),t.selectedRide=t.rides.find((function(e){return e.isSelected}))}else t.rides=r.filter(L),t.selectedRide={};return new Promise((function(e){return a.setState(t,e)}))},a.undoPath=function(){var e=a.state.path;a.setPath(e.slice(0,-1))},a.saveRide=function(e){var t=a.state,n=t.path,r=t.viewport,i="NEW_ID"===e.id,o=i?v()():e.id,c=Object(s.a)({},e,{id:o,viewport:r});return S(c).then(C).then((function(e){var t=Object(d.a)(e.filter(L));return!i&&n.length&&t.push(G(n,r)[0]),T(t,c)})).then((function(e){a.setState({rides:e,selectedRide:c,deleteFn:a.deleteRideFn(c),path:i?[]:n,isSaveDialogOpen:!1})}))},a.toggleDrawer=function(e){return a.setState({isDrawerOpen:e})},a.toggleSaveDialog=function(e){return a.setState({isSaveDialogOpen:e})},a.toggleDeleteConfirm=function(e){return a.setState({isDeleteConfirmOpen:e})},a.setViewport=function(e){return a.setState({viewport:e})},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.rides,a=e.selectedRide,n=e.path,i=e.viewport,o=e.isDrawerOpen,c=e.isSaveDialogOpen,l=e.isDeleteConfirmOpen,s=e.deleteFn,u=this.props.match.params.riders,m=t.filter((function(e){return u.split(",").map((function(t){return e.riders.includes(t)||!e.riders})).every((function(e){return e}))})),p=Object(d.a)(m.map(F)),g=!!n.length&&a&&"NEW_ID"===a.id;return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(V.a,null),r.a.createElement(le,{isDrawerOpen:o,toggleDrawer:this.toggleDrawer,riders:u,addRider:this.addRider,removeRider:this.removeRider}),r.a.createElement(ge,{isDrawerOpen:o,toggleDrawer:this.toggleDrawer},r.a.createElement(ze,{rides:m,selectRide:this.selectRide,toggleSaveDialog:this.toggleSaveDialog,toggleDeleteConfirm:this.toggleDeleteConfirm})),r.a.createElement($,{isDrawerOpen:o},r.a.createElement(Le,{viewport:i,setViewport:this.setViewport,path:n,setPath:this.setPath,layers:p}),a.id&&r.a.createElement(we,{ride:a}),g&&r.a.createElement(Ve,{undoPath:this.undoPath,toggleSaveDialog:this.toggleSaveDialog,toggleDeleteConfirm:this.toggleDeleteConfirm})),r.a.createElement(et,{open:c,toggle:this.toggleSaveDialog,ride:a,saveRide:this.saveRide}),r.a.createElement(tt,{open:l,toggle:this.toggleDeleteConfirm,deleteFn:s}))}}]),t}(r.a.Component),nt=Object(l.h)(at);o.a.render(r.a.createElement(c.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/:riders([nathan|sarah|jesse|,]+)/:rideId?",component:nt}),r.a.createElement(l.b,{render:function(){return r.a.createElement(l.a,{to:"/nathan,sarah,jesse"})}}))),document.getElementById("root"))},98:function(e,t,a){e.exports=a.p+"static/media/nathan.ee2493ef.png"},99:function(e,t,a){e.exports=a.p+"static/media/sarah.24ca4f60.jpeg"}},[[327,1,2]]]);
//# sourceMappingURL=main.8e6f1b64.chunk.js.map